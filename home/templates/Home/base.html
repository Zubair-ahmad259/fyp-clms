 {% load static %}

<!DOCTYPE html>
<html lang="en">
 <head> 
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
      <title>dept of computer science uoswabi - Dashboard</title>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,500;0,600;0,700;1,400&amp;display=swap">

      <link rel="stylesheet" href="{%static 'assets/plugins/bootstrap/css/bootstrap.min.css' %}">

      <link rel="stylesheet" href="{%static 'assets/plugins/fontawesome/css/fontawesome.min.css' %}">

      <link rel="stylesheet" href="{%static 'assets/plugins/fontawesome/css/all.min.css' %}">
      <link rel="stylesheet" href="{%static 'assets/css/style.css' %}">
   </head>
   <body>

      
      <div class="main-wrapper">
         <div class="header">
            <div class="header-left">
               <a href="index.html" class="logo">
          <img src="{% static 'assets/images/uni logo.jpg' %}" alt="Logo" width="30" height="30">
               </a>
               <a href="index.html" class="logo logo-small">
               <img src="assets/images/usericion.svg" alt="Logo" width="30" height="30">
               </a>
            </div>
            {% comment %} <a href="javascript:void(0);" id="toggle_btn"> {% endcomment %}
            <i class="fas fa-align-left"></i>
            </a>
            <div class="top-nav-search">
               <form>
                  <input type="text" class="form-control" placeholder="Search here">
                  <button class="btn" type="submit"><i class="fas fa-search"></i></button>
               </form>
            </div>
            <a class="mobile_btn" id="mobile_btn">
            <i class="fas fa-bars"></i>
            </a>
            <ul class="nav user-menu">
               <li class="nav-item dropdown noti-dropdown">
                  <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                   {% if unread_notification_count > 0 %}
                  <i class="far fa-bell"></i> <span class="badge badge-pill">{{unread_notification_count}}</span>
                  {% endif %}
                  </a>
                  <div class="dropdown-menu notifications">
                     <div class="topnav-dropdown-header">
                        <span class="notification-title">Notifications</span>
                        <a href="javascript:void(0)" class="clear-noti"> Clear All </a>
                     </div>
                     <div class="noti-content">
                        <ul class="notification-list">
                           {% for notification in unread_notification %}
                           <li class="notification-message">
                              <a href="#">
                                 <div class="media">
                                    <span class="avatar avatar-sm">
                                    <img class="avatar-img rounded-circle" alt="User Image" src="assets/img/profiles/avatar-02.jpg">
                                    </span>
                                    <div class="media-body">
                                       <p class="noti-details"><span class="noti-title">{{ notification.user.username }}</span> {{ notification.message }} <span class="noti-title">your estimate</span></p>
                                       <p class="noti-time"><span class="notification-time">{{ notification.created_at|timesince }} ago</span></p>
                                    </div>
                                 </div>
                              </a>
                           </li>
                           {% endfor %}

                        </ul>
                     </div>
                     <div class="topnav-dropdown-footer">
                        <a href="#">View all Notifications</a>
                     </div>
                  </div>
               </li>
               <li class="nav-item dropdown has-arrow">
                  <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
                  <span class="user-img"><img class="rounded-circle" src="assets/images/usericion.svg" width="31" alt="Ryan Taylor"></span>
                  </a>
                  <div class="dropdown-menu">
                     <div class="user-header">
                        <div class="avatar avatar-sm">
                           <img src="assets/img/profiles/avatar-01.jpg" alt="User Image" class="avatar-img rounded-circle">
                        </div>
                        <div class="user-text">
                           {% comment %} <h6>{{request.user.first_name}}</h6> {% endcomment %}
                           <p class="text-muted mb-0">Administrator</p>
                        </div>
                     </div>
                     <a class="dropdown-item" href="profile.html">My Profile</a>
                     <a class="dropdown-item" href="inbox.html">Inbox</a>
                     {% comment %} <a class="dropdown-item" href="{% url 'logout' %}">Logout</a> {% endcomment %}
                  </div>
               </li>
            </ul>
         </div>
         <div class="sidebar" id="sidebar">
            <div class="sidebar-inner slimscroll">
               <div id="sidebar-menu" class="sidebar-menu">
                  <ul>
                     <li class="menu-title">
                        <span>Main Menu</span>
                     </li>
                     
                       <li class="menu-title">
                        <span>User Management</span>
                     </li>
                     <li class="submenu">
                        <a href="#"><i class="fas fa-user-graduate"></i> <span> Students</span> <span class="menu-arrow"></span></a>
                        <ul>
                           <li><a href="{% url 'student_list' %}">Student List</a></li>
                           <li><a href="{% url 'add_student' %}">Student Add</a></li>
                        </ul>
                     </li>
                     <li class="submenu">
                        <a href="#"><i class="fas fa-chalkboard-teacher"></i> <span> Teachers</span> <span class="menu-arrow"></span></a>
                        <ul>
                           <li><a href="{% url "teacher_list" %}">Teacher List</a></li>
                           <li><a href="{% url "add_teacher" %}">Teacher Add</a></li>

                        </ul>
                     </li>

                                 <li class="submenu">
                        <a href="#"><i class="fas fa-shield-alt"></i> <span> Authentication </span> <span class="menu-arrow"></span></a>
                        <ul>
                           {% comment %} <li><a href="{% url '#' %}">Login</a></li> {% endcomment %}
                           <li><a href="{% url 'signup' %}">Students Registeration</a></li>
                           <li><a href="{% url 'manage_teachers_view' %}">Teacher Registeration</a></li>
                        
                           <li><a href="{% url "manage_admins_view" %} ">Admin Registeration</a></li>
                        </ul>
                     </li>
               
                       <li class="menu-title">
                        <span>Acadamic Management</span>
                     </li>

                     <li class="submenu">
                        <a href="#"><i class="fas fa-book-reader"></i> <span> Subjects</span> <span class="menu-arrow"></span></a>
                        <ul>

                           <li><a href="{% url "subjects:view_subject" %}">Subject List</a></li>
                           <li><a href="{% url "subjects:add_subject" %}">Subject Add</a></li>
                           <li><a href="{% url "subjects:add_subject_assign" %}">Add subject assign</a></li>
                           <li><a href="{% url "subjects:show_subject_assign" %}">Subject Add</a></li>

                        </ul>
                     </li>

                         
                     <li>
                        <a href="#"><i class="fas fa-book-reader"></i> <span> exam system</span> <span class="menu-arrow"></span>
                            <ul>


                                     
                                      {% comment %} <li>  <a href="{% url 'exam:comprehensive_results_view'  %}"> {% endcomment %}
                                            View All Result  </a> </li>
                                  {% comment %} <li><a href="{% url "#" %}">add case</a></li> {% endcomment %}
                                  {% comment %} <li><a href="{% url "#" %}">view all  case</a></li> {% endcomment %}

                         </ul>
                         </a>
                     <li class="submenu">
                        <a href="#"><i class="fas fa-user-graduate"></i> <span> Discipline Committe</span> <span class="menu-arrow"></span></a>
                        <ul>
                           <li><a href="{% url 'case_list' %}">cases List</a></li>
                           <li><a href="{% url 'add_case' %}">Add case</a></li>
                        </ul>
                     </li>                  
                     
                     <li>
                        <li class="submenu">
                        <a href="#"><i class="fas fa-book-reader"></i> <span> Time Tables & Sheduling</span> <span class="menu-arrow"></span></a>
                           <ul>
                           <li><a href"#">create time table</a></li>

                          </ul>
                     </li>



                     <li class="menu-title">
                        <span>Accounts Management</span>
                     </li>
                     <li class="submenu">
                        <a href="#"><i class="fas fa-file-invoice-dollar"></i> <span> fee Managment</span> <span class="menu-arrow"></span></a>
                        <ul>
                            <a href="#"><i class="fas fa-money-bill-wave"></i> <span> Fee system</span> <span class="menu-arrow"></span></a>
                        <ul>

                                 <li><a href="{% url 'upload_fee' %}">upload Fee</a></li>
                                 {% comment %} <a href="{% url 'clear_fees'%}" >clear fee</a> {% endcomment %}
                                  <a href="{% url 'fee_list' %}" >fee overviews</a>
                                 <li><a href="{% url 'defaulter_student' %}">defualter student </a></li>
  


                             </a>
                             </li>
                           </ul>
                     </ul> 
                        <a href="#"><i class="fas fa-money-bill-wave"></i> <span> salary</span> <span class="menu-arrow"></span></a>

                           





                        
                     <li class="menu-title">
                        <span>opertions system</span>
                     </li>
                  
                     <li class="submenu">
                     <a href="#"><i class="fas fa-shield-alt"></i> <span> Attendance Traking </span> <span class="menu-arrow"></span></a>           
                     </li>
                  
                     <li class="submenu">
                     <a href="#"><i class="fas fa-shield-alt"></i> <span> Acdamic calander </span> <span class="menu-arrow"></span></a>           
                     </li>

                       <li class="submenu">
                     <a href="#"><i class="fas fa-shield-alt"></i> <span> Department Managment </span> <span class="menu-arrow"></span></a>           
                     </li>



         
                    
                
                    
              
                  </ul>
               </div>
            </div>
         </div>


         {% block body %}
            
         {% endblock %}

      </div>

 

    
      <script type="text/javascript">
          document.addEventListener('DOMContentLoaded', function() {
              // Select the notification dropdown element
              const notiDropdown = document.querySelector('.noti-dropdown');
              const clearAllBtn = document.querySelector('.clear-noti');
      
              if (notiDropdown) {
                  // Add a click event listener to the notification dropdown
                  notiDropdown.addEventListener('click', function() {
                     
                      {% comment %} const url = "{% url 'mark_notifications_as_read' %}"; {% endcomment %}
                      // Use the Fetch API to send a POST request to mark notifications as read
                      fetch(url, {
                          method: 'POST',
                          headers: {
                              {% comment %} 'X-CSRFToken': '{{ csrf_token }}', {% endcomment %}
                              'Content-Type': 'application/x-www-form-urlencoded',
                          }
                      })
                      .then(response => response.json())  // Parse the JSON response
                      .then(data => {
                          if (data.status === 'success') {
                              // Remove the badge if notifications are successfully marked as read
                              const badge = document.querySelector('.badge');
                              if (badge) {
                                  badge.remove();
                              }
                          }
                      })
                      .catch(error => {
                          console.error('Error:', error);  // Log any errors
                      });
                  });
              }
      
              if (clearAllBtn) {
                  // Add a click event listener to the "Clear All" button
                  clearAllBtn.addEventListener('click', function() {
                      {% comment %} const clearUrl = "{% url 'clear_all_notifications' %}";  // Ensure this URL points to the correct view {% endcomment %}
      
                      // Use Fetch to send a POST request to clear all notifications
                      fetch(clearUrl, {
                          method: 'POST',
                          headers: {
                              {% comment %} 'X-CSRFToken': '{{ csrf_token }}', {% endcomment %}
                              'Content-Type': 'application/x-www-form-urlencoded',
                          }
                      })
                      .then(response => response.json())  // Parse the JSON response
                      .then(data => {
                          if (data.status === 'success') {
                              // Clear all notifications from the dropdown
                              const notificationList = document.querySelector('.notification-list');
                              if (notificationList) {
                                  notificationList.innerHTML = '<li>No new notifications</li>';  // Optionally show a "No new notifications" message
                              }
                          }
                      })
                      .catch(error => {
                          console.error('Error:', error);  // Log any errors
                      });
                  });
              }
          });
          <script src="{% static 'assets/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>
      </script>
      
      
  </body>
  </html>
   